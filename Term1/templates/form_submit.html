<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>Document</title>
  <script src="https://code.jquery.com/jquery-latest.min.js"></script>	
  <link rel="stylesheet" type= "text/css" href="{{url_for('static',filename= 'style.css')}}">
</head>
 <body>
	 <div id = 'default'>
		<h3>Register page</h3>
		<form action="/hello" method="post" enctype="multipart/form-data">
		First name:<br>
		<input type="text" name="firstname" value=" ">
		<br>
		Last name:<br>
		<input type="text" name="lastname" value=" ">
		<br>
		Age:<br>
		<input type="text" name="age" value=" ">
		<br>
		Image:<br>
		<input type="file" name = "file" value = "">
		<br>
		<br>
		<input type="submit" value="Submit">
		<br><br>
		</form> 
		<button type="button" onclick="location.href='/list'">show list</button>
		<br><br>
	</div>

	<div id ="detail">
		<h3>Detail info</h3>
		<table>
			<tbody>
				<tr>
					<th>User</th>
					<th>Age</th>
					<th>Image</th>	
				</tr>
					<tr>
						<td><p>{{data['username']}}</p></td>
						<td><p>{{data['age']}}</p></td>
						<td><img src= "{{url_for('static', filename =  data['Image'])}}" alt="user Image" /></td> <!-- need to see again..!! -->
					</tr>
			</tbody>
		</table>
		<button type="button" onclick="location.href='/'">Go back to registration</button>
	</div>
	
	<script>

		let flag = '{{types}}'
		console.log(flag)
		if(flag === 'detail'){
			document.getElementById('default').style = "display:none"
			document.getElementById('detail').style = "display:block"
			//let datum = {{data | safe}};
			//datum = datum.replace(/"/g,"")
			let datum = '{{data.username}}'; // 계속 오류 났던 이유 : 처음에 접속하면 data를 주어지지 않는다. 이 경우 빈 값을 넣어준다. - 
			console.log(1)
			console.log(datum)
			console.log(typeof(datum))
			console.log(1)
			//let val = Object.assign({}, ...datum.map((x) => ({['USER']: x.USER})));
			//value = val["USER"]

			console.log(1)
			$.ajax({
				url : '/responsed?value='+datum, // 값이 안넘어온다. 이거 해결해야하나다111111111
				type : 'GET',
				data : {},
				success : (file)=>{
					alert(JSON.stringify(file));
					
				},
				error : ()=>{
					alert('Error!');
				}
			});
			
		}
		else{
			document.getElementById('default').style = "display:block"
			document.getElementById('detail').style = "display:none"
		}
	</script>

	
 </body>
</html>